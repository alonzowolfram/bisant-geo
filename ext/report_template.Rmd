---
output: html_notebook
title: 'GeoMx report'
params:
  pkc_summary_file: ''
  ntc_summary_file: ''
  qc_segments_summary_file: ''
  plot_list_qc_segments_file: ''
  plot_list_qc_probes_file: ''
  qc_probes_summary_file: ''
  goi_detection_rate_table_file: ''
  plot_list_normalization_file: ''
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)

# Getting arguments from the command line:
# https://stackoverflow.com/questions/49904943/run-rmarkdown-with-arguments-on-the-command-line/76567366#76567366
# https://bookdown.org/yihui/rmarkdown-cookbook/parameterized-reports.html#parameterized-reports

# Dynamically building Rmd files:
# https://stackoverflow.com/questions/62754099/dynamically-building-rmarkdown
# https://stackoverflow.com/questions/21729415/generate-dynamic-r-markdown-blocks

# Reading in external scripts into a chunk:
# https://bookdown.org/yihui/rmarkdown-cookbook/option-code.html

# How to do tabbed sections: 
# https://epirhandbook.com/new_pages/rmarkdown.html

# Embedding Shiny apps:
# https://bookdown.org/yihui/rmarkdown/shiny-embedded.html
```

# Study design
```{r}
if(file.exists(params$pkc_summary_file)) {
  pkc_summary_df <- readRDS(params$pkc_summary_file)
  knitr::kable(pkc_summary_df)
}

```

# QC - segments
```{r}
if(file.exists(params$qc_segments_summary_file)) {
  qc_segments_summary_df <- readRDS(params$qc_segments_summary_file)
  knitr::kable(qc_segments_summary_df)
}

if(file.exists(params$ntc_summary_file)) {
  ntc_summary_df <- readRDS(params$ntc_summary_file)
  knitr::kable(ntc_summary_df)
}
```

```{r}
if(file.exists(params$plot_list_qc_segments_file)) {
  plot_list_qc_segments <- readRDS(params$plot_list_qc_segments_file)
  for(item in plot_list_qc_segments) {
    print(item)
  }
}
```

# QC - probes and targets
```{r}
if(file.exists(params$qc_probes_summary_file)) {
  qc_probes_summary <- readRDS(params$qc_probes_summary_file)
  knitr::kable(qc_probes_summary)
}
```

```{r}
if(file.exists(params$goi_detection_rate_table_file)) {
  goi_detection_rate_table <- readRDS(params$goi_detection_rate_table_file)
  knitr::kable(goi_detection_rate_table)
}
```

```{r}
if(file.exists(params$plot_list_qc_probes_file)) {
  plot_list_qc_probes <- readRDS(params$plot_list_qc_probes_file)
  for(item in plot_list_qc_probes) {
    print(item)
  }
}

```

# Normalization
```{r}
if(file.exists(params$plot_list_normalization_file)) {
  plot_list_normalization <- readRDS(params$plot_list_normalization_file)
  for(item in plot_list_normalization) {
    print(item)
  }
}
```


# Session info
```{r}
sessionInfo()
```